# AWS Elastic Container Registry (ECR) Configuration
# Copy to ecr.env and configure for ECR usage

# AWS Region
AWS_REGION=us-east-1

# AWS Account ID
AWS_ACCOUNT_ID=123456789012

# Registry URL (constructed from account and region)
REGISTRY=${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com

# Image naming pattern: <account>.dkr.ecr.<region>.amazonaws.com/<repo>:<tag>
# Example: 123456789012.dkr.ecr.us-east-1.amazonaws.com/api:1.0.0

# Required GitHub Secrets:
# AWS_ACCESS_KEY_ID - AWS access key
# AWS_SECRET_ACCESS_KEY - AWS secret key
# (Or use OIDC for keyless auth - recommended)

# Required AWS permissions (IAM policy):
# {
#   "Version": "2012-10-17",
#   "Statement": [
#     {
#       "Effect": "Allow",
#       "Action": [
#         "ecr:GetAuthorizationToken",
#         "ecr:BatchCheckLayerAvailability",
#         "ecr:GetDownloadUrlForLayer",
#         "ecr:BatchGetImage",
#         "ecr:PutImage",
#         "ecr:InitiateLayerUpload",
#         "ecr:UploadLayerPart",
#         "ecr:CompleteLayerUpload",
#         "ecr:CreateRepository"
#       ],
#       "Resource": "*"
#     }
#   ]
# }

# Workflow modifications needed:
# 1. Add AWS credentials step before login:
#    - name: Configure AWS credentials
#      uses: aws-actions/configure-aws-credentials@v4
#      with:
#        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
#        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#        aws-region: ${{ env.AWS_REGION }}
#
# 2. Update login step:
#    - name: Log in to Amazon ECR
#      uses: aws-actions/amazon-ecr-login@v2
#
# 3. Update image tags:
#    images: ${{ env.REGISTRY }}/${{ inputs.service }}

# For OIDC authentication (recommended for production):
# 1. Create an OIDC provider in AWS IAM for GitHub Actions
# 2. Create a role with the ECR permissions above
# 3. Use role-to-assume instead of access keys:
#    - name: Configure AWS credentials
#      uses: aws-actions/configure-aws-credentials@v4
#      with:
#        role-to-assume: arn:aws:iam::123456789012:role/GitHubActionsECR
#        aws-region: us-east-1

# ECR repository creation (run once per service):
# aws ecr create-repository --repository-name api --region us-east-1
# aws ecr create-repository --repository-name auth --region us-east-1
# aws ecr create-repository --repository-name dashboard --region us-east-1
